<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8" />
  <title>Detail Buku | Perpus Online</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
</head>
<body>
  <div class="container mt-4">
    <a href="/user/index" class="btn btn-link">&larr; Kembali</a>
    <div id="detailBuku" class="card p-4 mt-2 shadow-sm"></div>
  </div>

<script>
$(document).ready(function(){
  const params = new URLSearchParams(window.location.search);
  const id = params.get('id');

  if(!id) {
    $('#detailBuku').html('<p>ID buku tidak ditemukan.</p>');
    return;
  }

  $.ajax({
    url: `/api/buku/${id}`,
    method: 'GET',
    success: function(buku) {
      const imgTag = buku.gambar 
        ? `<img src="/uploads/${buku.gambar}" class="img-fluid rounded mb-3" alt="${buku.judul}" />`
        : '<div class="bg-light text-center py-5 mb-3 rounded">Tidak ada gambar</div>';

      const html = `
        <div class="row">
          <div class="col-md-4">
            ${imgTag}
          </div>
          <div class="col-md-8">
            <h3>${buku.judul}</h3>
            <p><strong>Penulis:</strong> ${buku.penulis}</p>
            <p><strong>Penerbit:</strong> ${buku.penerbit}</p>
            <p><strong>Tahun:</strong> ${buku.tahun}</p>
            <p><strong>Kategori:</strong> ${buku.kategori}</p>
            <p><strong>Stok:</strong> ${buku.stok}</p>
            <hr>
            <p>${buku.deskripsi ? buku.deskripsi : '<em>Tidak ada deskripsi</em>'}</p>
            <button class="btn btn-success mt-3">Pinjam Buku</button>
          </div>
        </div>
      `;
      $('#detailBuku').html(html);
    },
    error: function() {
      $('#detailBuku').html('<p>Data buku tidak ditemukan.</p>');
    }
  });
});
</script>
</body>
</html>
